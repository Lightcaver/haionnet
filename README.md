# haionnet
1. sophos에서 로그 파일을 다운로드 받는다. ( 본사 = firewall log, 서버용 = firewall log + waf log)
2. backup 파일을 생성 및 다운로드
3. 로우파일까지 전부 압축해제 -> 기존 알집으로 된 파일들 전부 삭제(.log파일만 남긴다.)
4. 그 뒤에 올바른 경로를 대상으로 1 -> 2 -> 3 -> modify가 없는 일반 xlsl 파일 삭제 -> 4 -> transname_ver1 실행


python의 경우 venv 가상환경을 통해서 셋업했고 버전은 3.10.2



해당 코드들을 통해 이루어져야 하는 작업 프로세스는 아래와 같음

엑셀 open

데이터 > 텍스트로 해당 방화벽 로그파일 찾아서 열기

구분기호로 분리됨 클릭 , 공백 클릭 후 마침하고 확인

제일 윗 줄 클릭하고 마우스 우클릭 후 삽입하고 공백 칸 생기면 필터 버튼 클릭

B~I까지 삭제

B필터에서 오름차순으로 정렬 ( GEOIP삭제 및 셀을 왼쪽으로 밀기)

C삭제

다시 C 내림차순 정렬 및 outint 부분 오른쪽으로 밀기

D내림차순으로해서 srcmac=부분 오른쪽으로 밀기

F열 내림차순으로 정렬 및 srcip= 부분 오른쪽으로 밀기

I~M까지 삭제

I열 내림차순정렬 (type=하고 옆에 J열에 있는 code=0하고 드래그해서 우측으로 밀기

K열이후로는 삭제

A열 오름차순 정렬후 저장

해당 내용으로 필터에 입력

시간		정책		In 인터페이스		Out 인터페이스	출발지 물리적 주소			목적지 물리적 주소	출발지 아이피			목적지 아이피			출발지 포트	목적지 포트

해당 내용으로 필터에 입력
